<!-- verificacion-reintegros.component.html -->
<div class="container mx-auto p-6">
    <!-- Encabezado -->
    <div class="flex justify-between items-center mb-8">
        <div>
            <h1 class="text-3xl font-bold text-gray-900 mb-2">
                <span class="text-transparent bg-clip-text bg-gradient-to-r from-green-600 to-blue-600">
                    Verificación de Reintegros
                </span>
            </h1>
            <p class="text-gray-600">Panel de verificación y aprobación de reintegros de anticipos</p>
        </div>

        <!-- Estadísticas rápidas -->
        <div class="grid grid-cols-3 gap-4">
            <div class="bg-yellow-50 rounded-lg p-4 text-center border border-yellow-200">
                <div class="text-2xl font-bold text-yellow-600">{{ estadisticas.total_pendientes }}</div>
                <div class="text-sm text-yellow-700">Pendientes</div>
            </div>
            <div class="bg-green-50 rounded-lg p-4 text-center border border-green-200">
                <div class="text-2xl font-bold text-green-600">{{ estadisticas.total_verificados_hoy }}</div>
                <div class="text-sm text-green-700">Verificados Hoy</div>
            </div>
            <div class="bg-blue-50 rounded-lg p-4 text-center border border-blue-200">
                <div class="text-2xl font-bold text-blue-600">{{
                    UtilidadesReintegros.formatearMonto(estadisticas.monto_total_pendiente) }}</div>
                <div class="text-sm text-blue-700">Monto Pendiente</div>
            </div>
        </div>
    </div>

    <!-- Panel de filtros -->
    <div class="bg-white rounded-lg shadow-md p-6 mb-8">
        <h2 class="text-lg font-semibold text-gray-800 mb-4 flex items-center">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2 text-green-600" fill="none" viewBox="0 0 24 24"
                stroke-width="1.5" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round"
                    d="M12 3c2.755 0 5.455.232 8.083.678.533.09.917.556.917 1.096v1.044a2.25 2.25 0 01-.659 1.591l-5.432 5.432a2.25 2.25 0 00-.659 1.591v2.927a2.25 2.25 0 01-1.244 2.013L9.75 21v-6.568a2.25 2.25 0 00-.659-1.591L3.659 7.409A2.25 2.25 0 013 5.818V4.774c0-.54.384-1.006.917-1.096A48.32 48.32 0 0112 3z" />
            </svg>
            Filtros de Búsqueda
        </h2>

        <div class="grid grid-cols-1 md:grid-cols-4 gap-4 items-end">
            <!-- Estado -->
            <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">Estado</label>
                <select [(ngModel)]="filtros.estado"
                    class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent bg-white">
                    <option *ngFor="let estado of ESTADOS_REINTEGRO" [value]="estado.valor">
                        {{ estado.etiqueta }}
                    </option>
                </select>
            </div>

            <!-- Fecha inicio -->
            <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">Fecha Inicio</label>
                <input type="date" [(ngModel)]="filtros.fecha_inicio"
                    class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent">
            </div>

            <!-- Fecha fin -->
            <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">Fecha Fin</label>
                <input type="date" [(ngModel)]="filtros.fecha_fin"
                    class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent">
            </div>

            <!-- Botones de acción -->
            <div class="flex gap-2">
                <button (click)="aplicarFiltros()"
                    class="flex-1 bg-green-600 text-white px-4 py-2 rounded-md hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2 transition-colors">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 inline mr-1" fill="none" viewBox="0 0 24 24"
                        stroke-width="1.5" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round"
                            d="M21 21l-5.197-5.197m0 0A7.5 7.5 0 105.196 5.196a7.5 7.5 0 0110.607 10.607z" />
                    </svg>
                    Filtrar
                </button>

                <button (click)="limpiarFiltros()"
                    class="px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2 transition-colors">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 inline" fill="none" viewBox="0 0 24 24"
                        stroke-width="1.5" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" />
                    </svg>
                </button>
            </div>
        </div>
    </div>

    <!-- Indicador de carga -->
    <div *ngIf="cargandoReintegros" class="flex justify-center items-center p-12">
        <div class="text-center">
            <div class="animate-spin rounded-full h-12 w-12 border-b-2 border-green-600 mx-auto mb-4"></div>
            <p class="text-gray-600 font-medium">Cargando reintegros para verificación...</p>
        </div>
    </div>

    <!-- Tabla de reintegros -->
    <div *ngIf="!cargandoReintegros" class="bg-white rounded-lg shadow-lg">
        <div class="px-6 py-4 border-b border-gray-200">
            <h2 class="text-xl font-semibold text-gray-800 flex items-center">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 mr-2 text-green-600" fill="none"
                    viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round"
                        d="M9 12.75L11.25 15 15 9.75M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                </svg>
                Reintegros para Verificación
                <span
                    class="ml-3 inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800">
                    {{ reintegrosPendientes.length }}
                </span>
            </h2>
        </div>

        <app-generic-table [data]="reintegrosPendientes" [columns]="columnas" [actions]="acciones"
            [config]="configTabla" (rowAction)="manejarAccionFila($event)" (pageChange)="cambiarPagina($event)"
            (pageSizeChange)="cambiarTamanoPagina($event)" (sortChange)="cambiarOrden($event)">
        </app-generic-table>
    </div>

    <!-- Estado vacío cuando no hay reintegros -->
    <div *ngIf="!cargandoReintegros && reintegrosPendientes.length === 0"
        class="bg-white rounded-lg shadow-md p-16 text-center">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-20 w-20 text-gray-300 mx-auto mb-6" fill="none"
            viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round"
                d="M9 12.75L11.25 15 15 9.75M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
        </svg>
        <h3 class="text-xl font-semibold text-gray-900 mb-3">No hay reintegros para verificar</h3>
        <p class="text-gray-600 mb-6 max-w-md mx-auto">
            No se encontraron reintegros que coincidan con los criterios de búsqueda seleccionados.
        </p>

        <!-- Sugerencias según el estado -->
        <div class="space-y-3">
            <div *ngIf="filtros.estado === 'pendiente'" class="text-sm text-gray-500">
                <p>¡Excelente! No hay reintegros pendientes de verificación.</p>
            </div>
            <div *ngIf="filtros.estado === 'verificado'" class="text-sm text-gray-500">
                <p>No se encontraron reintegros verificados en el período seleccionado.</p>
            </div>
            <div *ngIf="filtros.estado === 'rechazado'" class="text-sm text-gray-500">
                <p>No hay reintegros rechazados que requieran seguimiento.</p>
            </div>

            <button (click)="limpiarFiltros()"
                class="bg-green-600 text-white px-6 py-2 rounded-lg font-medium hover:bg-green-700 transition-colors">
                Mostrar Todos los Pendientes
            </button>
        </div>
    </div>

    <!-- Panel de ayuda para verificadores -->
    <div class="mt-8 bg-gradient-to-br from-green-50 to-blue-50 rounded-lg p-6 border border-green-100">
        <h3 class="text-lg font-semibold text-gray-800 mb-4 flex items-center">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2 text-green-600" fill="none" viewBox="0 0 24 24"
                stroke-width="1.5" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round"
                    d="M11.25 11.25l.041-.02a.75.75 0 011.063.852l-.708 2.836a.75.75 0 001.063.853l.041-.021M21 12a9 9 0 11-18 0 9 9 0 0118 0zm-9-3.75h.008v.008H12V8.25z" />
            </svg>
            Guía para Verificadores
        </h3>

        <div class="grid grid-cols-1 md:grid-cols-2 gap-6 text-sm">
            <div class="space-y-4">
                <div class="bg-white rounded-lg p-4 border-l-4 border-green-400">
                    <h4 class="font-semibold text-green-800 mb-2">Proceso de Verificación</h4>
                    <ul class="text-green-700 space-y-1">
                        <li>• Revisar completitud de información</li>
                        <li>• Verificar montos y referencias</li>
                        <li>• Validar documentación bancaria</li>
                        <li>• Aprobar o solicitar correcciones</li>
                    </ul>
                </div>

                <div class="bg-white rounded-lg p-4 border-l-4 border-blue-400">
                    <h4 class="font-semibold text-blue-800 mb-2">Elementos a Revisar</h4>
                    <ul class="text-blue-700 space-y-1">
                        <li>• Número de boleta válido y único</li>
                        <li>• Monto correcto del reintegro</li>
                        <li>• Fecha de transacción coherente</li>
                        <li>• Información bancaria completa</li>
                    </ul>
                </div>
            </div>

            <div class="space-y-4">
                <div class="bg-white rounded-lg p-4 border-l-4 border-orange-400">
                    <h4 class="font-semibold text-orange-800 mb-2">Criterios de Rechazo</h4>
                    <ul class="text-orange-700 space-y-1">
                        <li>• Información incompleta o errónea</li>
                        <li>• Documentación faltante</li>
                        <li>• Montos que no coinciden</li>
                        <li>• Fechas inconsistentes</li>
                    </ul>
                </div>

                <div class="bg-white rounded-lg p-4 border-l-4 border-purple-400">
                    <h4 class="font-semibold text-purple-800 mb-2">Mejores Prácticas</h4>
                    <ul class="text-purple-700 space-y-1">
                        <li>• Ser específico en observaciones</li>
                        <li>• Procesar de forma oportuna</li>
                        <li>• Mantener comunicación clara</li>
                        <li>• Documentar decisiones</li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- Acciones rápidas para verificadores -->
        <div class="mt-6 pt-4 border-t border-green-200">
            <h4 class="font-semibold text-gray-800 mb-3">Acciones Rápidas</h4>
            <div class="flex flex-wrap gap-3">
                <button (click)="filtros.estado = 'pendiente'; aplicarFiltros()"
                    class="bg-yellow-100 hover:bg-yellow-200 text-yellow-800 px-4 py-2 rounded-lg text-sm font-medium transition-colors">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 inline mr-1" fill="none" viewBox="0 0 24 24"
                        stroke-width="1.5" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round"
                            d="M12 6v6h4.5m4.5 0a9 9 0 11-18 0 9 9 0 0118 0z" />
                    </svg>
                    Ver Pendientes
                </button>

                <button (click)="filtros.estado = 'verificado'; aplicarFiltros()"
                    class="bg-green-100 hover:bg-green-200 text-green-800 px-4 py-2 rounded-lg text-sm font-medium transition-colors">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 inline mr-1" fill="none" viewBox="0 0 24 24"
                        stroke-width="1.5" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M4.5 12.75l6 6 9-13.5" />
                    </svg>
                    Ver Verificados
                </button>

                <button (click)="filtros.estado = 'rechazado'; aplicarFiltros()"
                    class="bg-red-100 hover:bg-red-200 text-red-800 px-4 py-2 rounded-lg text-sm font-medium transition-colors">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 inline mr-1" fill="none" viewBox="0 0 24 24"
                        stroke-width="1.5" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round"
                            d="M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126zM12 15.75h.007v.008H12v-.008z" />
                    </svg>
                    Ver Rechazados
                </button>

                <button (click)="limpiarFiltros()"
                    class="bg-gray-100 hover:bg-gray-200 text-gray-700 px-4 py-2 rounded-lg text-sm font-medium transition-colors">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 inline mr-1" fill="none" viewBox="0 0 24 24"
                        stroke-width="1.5" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round"
                            d="M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0l3.181 3.183a8.25 8.25 0 0013.803-3.7M4.031 9.865a8.25 8.25 0 0113.803-3.7l3.181 3.182m0-4.991v4.99" />
                    </svg>
                    Restablecer
                </button>
            </div>
        </div>
    </div>
</div>